(function(e,t){"use strict";var n=e.module("ngSails",[]);n.service("$sails",["$q","$timeout",function(n,r){function u(){var e=n.defer(),t=e.promise;t.success=function(e){t.then(function(t){e(t)});return t};t.error=function(e){t.then(null,function(t){e(t)});return t};return e}function a(t,n){if(n&&e.isObject(n)&&n.status&&~~(n.status/100)!==2){t.reject(n)}else{t.resolve(n)}}var i=t.connect(),s=false,o=null;i.on("connect",function(){s=true;if(e.isFunction(o)){o();o=null}});i.on("disconnect",function(){s=false});return{reconnect:function(e,t){var n=function(){i.disconnect();if(i.socket!==undefined){i.socket.connect(e,t)}};if(s===true){n()}else{o=n}},disconnect:function(){i.disconnect()},emit:function(e,t){i.emit(e,t)},on:function(t,n){if(n!==undefined&&e.isFunction(n)){i.on(t,function(e){r(function(){n(e)})})}},get:function(t,n,r){var s=u();if(r===undefined&&e.isFunction(n)){r=n;n=null}s.promise.then(r);i.get(t,n,function(e){a(s,e)});return s.promise},post:function(t,n,r){var s=u();if(r===undefined&&e.isFunction(n)){r=n;n=null}s.promise.then(r);i.post(t,n,function(e){a(s,e)});return s.promise},put:function(t,n,r){var s=u();if(r===undefined&&e.isFunction(n)){r=n;n=null}s.promise.then(r);i.put(t,n,function(e){a(s,e)});return s.promise},"delete":function(t,n,r){var s=u();if(r===undefined&&e.isFunction(n)){r=n;n=null}s.promise.then(r);i["delete"](t,n,function(e){a(s,e)});return s.promise}}}])})(angular,io)
